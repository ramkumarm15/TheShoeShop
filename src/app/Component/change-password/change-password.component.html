<main class="page-wrapper">
  <section class="container-fluid">
    <div class="row min-vh-100 mt-3 pt-5">
      <aside class="col-lg-2 col-md-4 border-end pb-md-5 mb-md-5">
        <app-profile-sidenav></app-profile-sidenav>
      </aside>
      <div class="col-md-8 offset-lg-1 pt-5">
        <h2 class="pt-2 pb-3">Security</h2>
        <!-- Basic info -->
        <h5 class="text-primary mb-4">Password</h5>
        <form class="needs-validation border-bottom pb-3 pb-lg-4" novalidate="" [formGroup]="changePasswordForm"
          (ngSubmit)="onSubmit()">
          <div class="row">
            <div class="col-sm-6 mb-4">
              <label for="cp" class="form-label fs-base">Current password</label>
              <input type="password" class="form-control form-control-lg" name="oldPassword" id="oldPassword"
                formControlName="oldPassword" required [ngClass]="{
                  'is-invalid':
                    changePasswordForm.controls['oldPassword'].invalid &&
                    changePasswordForm.controls['oldPassword'].touched,
                  '': changePasswordForm.controls['oldPassword'].valid
                }" />
              <div class="invalid-feedback" *ngIf="(changePasswordForm.controls['oldPassword'].touched 
                || changePasswordForm.controls['oldPassword'].invalid ) 
                && changePasswordForm.controls['oldPassword'].errors?.['required']">
                This field is required
              </div>
              <div class="invalid-feedback" *ngIf="(changePasswordForm.controls['oldPassword'].touched 
                || changePasswordForm.controls['oldPassword'].invalid ) 
                && changePasswordForm.controls['oldPassword'].errors?.['minlength']">
                Minimum length is 8 characters
              </div>
            </div>
          </div>
          <div class="row pb-2">
            <div class="col-sm-6 mb-4">
              <label for="np" class="form-label fs-base">New password</label>
              <input type="password" class="form-control form-control-lg" name="newPassword" id="newPassword"
                formControlName="newPassword" required [ngClass]="{
                  'is-invalid':
                    changePasswordForm.controls['newPassword'].invalid &&
                    changePasswordForm.controls['newPassword'].touched,
                  '': changePasswordForm.controls['newPassword'].valid
                }" />
              <div class="invalid-feedback" *ngIf=" (changePasswordForm.controls['newPassword'].touched 
                || changePasswordForm.controls['newPassword'].invalid)
                && changePasswordForm.controls['newPassword'].errors?.['required']">
                This field is required
              </div>
              <div class="invalid-feedback" *ngIf=" (changePasswordForm.controls['newPassword'].touched 
                || changePasswordForm.controls['newPassword'].invalid)
                && changePasswordForm.controls['newPassword'].errors?.['minlength']">
                Minimum length is 8 characters
              </div>
            </div>
            <div class="col-sm-6 mb-4">
              <label for="cnp" class="form-label fs-base">Confirm new password</label>
              <input type="password" class="form-control form-control-lg" name="confirmPassword" id="confirmPassword"
                formControlName="confirmPassword" required [ngClass]="{
                  'is-invalid':
                    changePasswordForm.controls['confirmPassword'].invalid &&
                    changePasswordForm.controls['confirmPassword'].touched,
                  '': changePasswordForm.controls['confirmPassword'].valid
                }" />

              <div class="invalid-feedback" *ngIf=" (changePasswordForm.controls['confirmPassword'].touched 
                || changePasswordForm.controls['confirmPassword'].invalid)
                && changePasswordForm.controls['confirmPassword'].errors?.['required']">
                This field is required
              </div>
              <div class="invalid-feedback" *ngIf=" (changePasswordForm.controls['confirmPassword'].touched 
                || changePasswordForm.controls['confirmPassword'].invalid)
                && changePasswordForm.controls['confirmPassword'].errors?.['minlength']">
                Minimum length is 8 characters
              </div>
              <div class="invalid-feedback" *ngIf="changePasswordForm.controls['confirmPassword'].errors?.['compare']">
                Both New Password and Confirm password not match
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-end mb-3">
            <ng-container *ngIf="!loading; else elseButton">
              <button type="submit" class="btn btn-primary" [disabled]="changePasswordForm.invalid">
                Save changes
              </button>
            </ng-container>
            <ng-template #elseButton>
              <button type="button" class="btn btn-primary pe-none">
                <span class="spinner-grow spinner-grow-sm me-2" role="status" aria-hidden="true"></span>
                <span>Saving...</span>
              </button>
            </ng-template>
          </div>
        </form>
      </div>
    </div>
  </section>
</main>